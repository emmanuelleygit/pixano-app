(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{100:function(t,e,s){"use strict";s.d(e,"c",(function(){return h})),s.d(e,"b",(function(){return c})),s.d(e,"d",(function(){return d})),s.d(e,"e",(function(){return l})),s.d(e,"a",(function(){return u})),s.d(e,"f",(function(){return r}));var i=s(393),a=s.n(i),r=s(120);const n=new WeakMap,o=new WeakMap;function h(t){if(n.has(t))return t;const e=a()(t,(function(t,e){for(const s of[...n.get(this)])s(t,e)}));return n.set(e,[]),o.set(e,[]),e}class c extends Set{constructor(...t){super(...t),n.set(this,[]),o.set(this,[])}add(t){super.add(t);for(const e of[...n.get(this)])e("add",t);return this}delete(t){const e=super.delete(t);for(const e of[...n.get(this)])e("delete",t);return e}clear(){if(this.size){super.clear();for(const t of[...n.get(this)])t("clear")}}set(t){super.clear(),t.forEach(t=>{super.add(t)});for(const e of[...n.get(this)])e("set",t)}}Map;function d(t,e,s=10){const i=n.get(t),a=o.get(t);if(!i||!a)throw new Error("object is not observable. If you meant to observe its properties, use `observable` first.");const h=Object(r.searchSorted)(a,s);return i.splice(h,0,e),a.splice(h,0,s),e}function l(t,e){const s=n.get(t),i=o.get(t);if(s&&i){const t=s.indexOf(e);t>=0&&(s.splice(t,1),i.splice(t,1))}}class u{constructor(){this.listeners=new Map}addEventListener(t,e){const s=this.listeners.get(t);s?s.push(e):this.listeners.set(t,[e])}removeEventListener(t,e){const s=this.listeners.get(t);if(s){const t=s.indexOf(e);t>=0&&s.splice(t,1)}}dispatchEvent(t){const e=this.listeners.get(t.type);if(e){for(const s of e)s.call(this,t);return!t.defaultPrevented}return!0}}},113:function(t,e,s){"use strict";s.d(e,"a",(function(){return r.a})),s.d(e,"b",(function(){return u})),s.d(e,"d",(function(){return a.a})),s.d(e,"c",(function(){return l.a})),s.d(e,"f",(function(){return h})),s.d(e,"e",(function(){return c})),s.d(e,"g",(function(){return d}));var i=s(167);i.d;var a=s(321),r=s(375),n=s(100),o=s(262);class h extends r.b{constructor(t){super(t),this.midnodes=[],this.nodes=[],this.nodeListeners=new Map,this.midnodeListeners=new Map,this.createNodes()}get lastXn(){return this.data.geometry.vertices[this.data.geometry.vertices.length-2]}get lastYn(){return this.data.geometry.vertices[this.data.geometry.vertices.length-1]}get lastX(){return this.data.geometry.vertices[this.data.geometry.vertices.length-2]*this.scaleX}get lastY(){return this.data.geometry.vertices[this.data.geometry.vertices.length-1]*this.scaleY}get isOpen(){return this.data.geometry.isOpened}addNodeListener(t,e){this.nodeListeners.set(t,e),this.applyNodeListeners()}addMidnodeListener(t,e){this.midnodeListeners.set(t,e),this.applyMidnodeListeners()}removeNodeListeners(){this.midnodeListeners.clear(),this.nodeListeners.clear(),this.applyMidnodeListeners(),this.applyNodeListeners()}applyMidnodeListeners(){this.midnodes.forEach((t,e)=>{t.removeAllListeners(),t.interactive=!1,t.buttonMode=!1,this.midnodeListeners.forEach((s,i)=>{t.interactive=!0,t.buttonMode=!0,t.cursor="cell",t.on(i,t=>{t.nodeIdx=e,s(t)})})})}applyNodeListeners(){this.nodes.forEach((t,e)=>{t.removeAllListeners(),t.interactive=!1,t.buttonMode=!1,this.nodeListeners.forEach((s,i)=>{t.interactive=!0,t.buttonMode=!0,t.cursor="grab",t.on(i,t=>{t.nodeIdx=e,s(t)})})})}createNodes(){this.nodes=new Array(.5*this.data.geometry.vertices.length).fill(null).map(()=>{const t=new i.e;return this.nodeContainer.addChild(t),t}),this.midnodes=new Array(.5*this.data.geometry.vertices.length).fill(null).map(()=>{const t=new i.e;return this.nodeContainer.addChild(t),t}),this.applyNodeListeners(),this.applyMidnodeListeners()}deleteNodes(){this.nodes.forEach(t=>{t.destroy(),this.nodeContainer.removeChild(t)}),this.midnodes.forEach(t=>{t.destroy(),this.nodeContainer.removeChild(t)})}getHitAreaForOpenPolygon(t){return new i.g(t.reduce((t,e,s)=>(t.splice(s,0,e-10),s%2==0?t.splice(s+1,0,e+10):t.splice(s+2,0,e+10),t),[]))}draw(){let t=this.data.geometry.vertices.map((t,e)=>e%2==0?Math.round(t*this.scaleX):Math.round(t*this.scaleY));if(this.isOpen||(t=t.concat([t[0],t[1]])),this.area.clear(),this.area.lineStyle(1,this.hex,1,.5,!0),4===this.data.geometry.vertices.length)this.area.moveTo(t[0],t[1]),this.area.lineTo(t[2],t[3]),this.isOpen&&(this.area.hitArea=this.getHitAreaForOpenPolygon(t));else if(this.data.geometry.vertices.length>4&&this.isOpen){for(let e=0;e<=this.data.geometry.vertices.length-4;e+=2)this.area.moveTo(t[e],t[e+1]),this.area.lineTo(t[e+2],t[e+3]);this.area.hitArea=this.getHitAreaForOpenPolygon(t)}else this.data.geometry.vertices.length>4&&(this.area.beginFill(this.hex,.15),this.area.drawPolygon(t),this.area.endFill());if(this.box.clear(),this.controls.forEach(t=>t.clear()),this.nodes.length!==.5*this.data.geometry.vertices.length?(this.deleteNodes(),this.createNodes()):(this.nodes.forEach(t=>t.clear()),this.midnodes.forEach(t=>t.clear())),this.controls.forEach(t=>{t.interactive=!1,t.buttonMode=!1}),"box"===this.state)this.drawBox();else if("contour"===this.state||"nodes"===this.state){if(this.box.lineStyle(1,16777215,1,.5,!0),this.area.lineStyle(1,16777215,1,.5,!0),4===this.data.geometry.vertices.length)this.area.moveTo(t[0],t[1]),this.area.lineTo(t[2],t[3]);else if(this.data.geometry.vertices.length>4&&this.isOpen)for(let e=0;e<=this.data.geometry.vertices.length-4;e+=2)this.area.moveTo(t[e],t[e+1]),this.area.lineTo(t[e+2],t[e+3]);else this.data.geometry.vertices.length>4&&this.area.drawPolygon(t);if("nodes"===this.state)for(let e=0;e<.5*this.data.geometry.vertices.length;e++){const s=this.data.geometry.vertices[2*e],a=this.data.geometry.vertices[2*e+1];this.nodes[e].clear(),this.nodes[e].beginFill(10934503,1),this.nodes[e].lineStyle(1,4353791,1,.5,!0),this.nodes[e].drawCircle(0,0,4),this.nodes[e].x=Math.round(s*this.scaleX),this.nodes[e].y=Math.round(a*this.scaleY),this.nodes[e].endFill(),this.nodes[e].scale.x=1.5/this.parent.parent.scale.x,this.nodes[e].scale.y=1.5/this.parent.parent.scale.y,this.midnodes[e].interactive=!0,this.midnodes[e].buttonMode=!0,this.midnodes[e].beginFill(0,1),this.midnodes[e].lineStyle(1,this.hex,1,.5,!0);const r=.5*(t[2*e]+t[2*e+2]),n=.5*(t[2*e+1]+t[2*e+3]);this.midnodes[e].drawCircle(0,0,3),this.midnodes[e].hitArea=new i.c(0,0,4),this.midnodes[e].x=r,this.midnodes[e].y=n,this.midnodes[e].visible=!0,this.midnodes[e].endFill(),this.midnodes[e].cursor="cell",this.midnodes[e].scale.x=1.5/this.parent.parent.scale.x,this.midnodes[e].scale.y=1.5/this.parent.parent.scale.y}}else this.nodeContainer.interactive=!1,this.nodes.forEach(t=>t.interactive=!1),this.controls.forEach(t=>t.interactive=!1)}isValid(){if(this.isOpen&&this.data.geometry.vertices.length>3)return!0;if(this.data.geometry.vertices.length<6)return!1;if(!Object(o.d)(this.data.geometry.vertices))return!1;{const t=this.bounds;if((t[3]-t[1])*this.scaleY<1||(t[2]-t[0])*this.scaleX<1)return!1}return!0}insertMidNode(t){const e=(t+1+this.data.geometry.vertices.length)%this.data.geometry.vertices.length;this.data.geometry.vertices=[...this.data.geometry.vertices.slice(0,2*e),.5*(this.data.geometry.vertices[2*t]+this.data.geometry.vertices[2*e]),.5*(this.data.geometry.vertices[2*t+1]+this.data.geometry.vertices[2*e+1]),...this.data.geometry.vertices.slice(2*e)]}pushNode(t,e){for(const[s,i]of this.data.geometry.vertices.slice(0,this.data.geometry.vertices.length-2).entries())if(s%2==0&&Math.round(i*this.scaleX)===Math.round(t*this.scaleX)&&Math.round(this.data.geometry.vertices[s+1]*this.scaleY)===Math.round(e*this.scaleY))return void console.warn("Same location. Abort.");this.data.geometry.vertices=[...this.data.geometry.vertices,t,e]}popNode(t=!0){this.data.geometry.vertices=t?this.data.geometry.vertices.slice(0,-2):[...this.data.geometry.vertices.slice(0,-4),...this.data.geometry.vertices.slice(-2)]}removeNode(t){this.data.geometry.vertices=[...this.data.geometry.vertices.slice(0,2*t),...this.data.geometry.vertices.slice(2*t+2)]}}class c extends r.b{constructor(t){super(t),this.subShapes=[],t.geometry.mvertices.forEach((e,s)=>{const i=Object.assign(Object.assign({},t),{geometry:{vertices:e,type:"polygon"},id:t.id}),a=new h(Object(n.c)(i));this.subShapes.push(a),this.area.addChild(a)})}onChange(t){"color"===t&&(this.updateColorHex(),this.draw())}draw(){this.subShapes.forEach(t=>{t.state="none"===this.state?"none":"contour",t.scaleX=this.scaleX,t.scaleY=this.scaleY,t.data.color=this.data.color,t.draw()})}}class d extends r.b{draw(){const t=this.scaleX,e=this.scaleY;this.area.clear(),this.area.removeChildren(),this.area.beginFill(this.hex,.15),this.area.lineStyle(1,this.hex,1,.5,!0);const s=Math.round(this.data.geometry.vertices[0]*t),i=Math.round(this.data.geometry.vertices[2]*t),a=Math.round(this.data.geometry.vertices[1]*e),r=Math.round(this.data.geometry.vertices[3]*e);this.area.drawRect(0,0,i-s,r-a),this.area.x=s,this.area.y=a,this.area.endFill(),this.box.clear(),this.controls.forEach(t=>t.clear()),"box"!==this.state&&"nodes"!==this.state&&"contour"!==this.state||(this.box.lineStyle(1,16777215,1,.5,!0),this.box.drawRect(s,a,i-s,r-a)),"box"===this.state||"nodes"===this.state?this.drawBox():(this.nodeContainer.interactive=!1,this.controls.forEach(t=>{t.buttonMode=!1,t.interactive=!1}))}}var l=s(268);class u extends i.e{constructor(){super(),this.cx=0,this.cy=0,this.scaleX=100,this.scaleY=100}draw(){this.parent&&(this.clear(),this.lineStyle(.75,16007990,1,.5,!0),this.moveTo(this.cx,0),this.lineTo(this.cx,this.scaleY),this.moveTo(0,this.cy),this.lineTo(this.scaleX,this.cy))}}},259:function(t,e,s){"use strict";s.d(e,"i",(function(){return a})),s.d(e,"e",(function(){return r})),s.d(e,"h",(function(){return n})),s.d(e,"g",(function(){return o})),s.d(e,"d",(function(){return h})),s.d(e,"b",(function(){return c})),s.d(e,"f",(function(){return d})),s.d(e,"c",(function(){return l})),s.d(e,"a",(function(){return u}));var i=s(167);function a(t){const e=Math.floor(t/65536),s=Math.floor(t%65536/256);return[t-65536*e-256*s,s,e]}function r(t){return t[0]+256*t[1]+65536*t[2]}function n(t,e){const s=t.x,i=t.y;let a=!1;for(let t=0,r=e.length-1;t<e.length;r=t++){e[t].y>i!=e[r].y>i&&s<(e[r].x-e[t].x)*(i-e[t].y)/(e[r].y-e[t].y)+e[t].x&&(a=!a)}return a}function o(t){let e=1e5,s=0,i=1e4,a=0;return t.forEach(t=>{t.x<e&&(e=t.x),t.x>s&&(s=t.x),t.y<i&&(i=t.y),t.y>a&&(a=t.y)}),[e,i,s,a]}function h(t,e){let[s,i,a,r]=t;const[n,o,h,c]=e;return n<s&&(s=n),o<i&&(i=o),h>a&&(a=h),c>r&&(r=c),[s,i,a,r]}function c(t,e){return t.map(t=>{const s=t/e|0,a=t%e;return new i.f(a,s)})}function d(t){let e=1e6,s=0,i=1e6,a=0;return t.forEach(t=>{t.data.forEach(t=>{t.x<e&&(e=t.x),t.x>s&&(s=t.x),t.y<i&&(i=t.y),t.y>a&&(a=t.y)})}),[e,i,s,a]}const l=[[230,25,75],[60,180,75],[255,225,25],[0,130,200],[245,130,48],[145,30,180],[70,240,240],[240,50,230],[210,245,60],[250,190,190],[0,128,128],[230,190,255],[170,110,40],[255,250,200],[128,0,0],[170,255,195],[128,128,0],[255,215,180],[0,0,128],[128,128,128]],u=(t,e)=>{if(t.length!==e.length)return!1;for(let s=0;s<t.length;s++)if(t[s]!==e[s])return!1;return!0}},265:function(t,e,s){"use strict";s.d(e,"a",(function(){return i}));class i extends EventTarget{constructor(t={}){super(),this._activated=!1,this.dispatchEvent=t.dispatchEvent||this.dispatchEvent}activate(){this._activated=!0}deactivate(){this._activated=!1}reset(){this.deactivate(),this.activate()}emit(t,e){this.dispatchEvent(new CustomEvent(t,{detail:e}))}}},268:function(t,e,s){"use strict";s.d(e,"b",(function(){return r})),s.d(e,"a",(function(){return n}));var i=s(167),a=s(375);const r={radius:4,nodeColors:[15079755,3978315,16769305,4416472,16089649,9510580,4649200,15741670,12383756,16432830,32896,15122175,10117924,16775880,8388608,11206595,8421376,16767153,117,8421504,16777215,0],edgeColorType:"node",edges:[[0,1],[0,2]],vertexNames:["header","RFoot","LFoot"],showVertexName:!0};class n extends a.b{constructor(t){super(t),this.nodes=[],this.colors=[16007990,16776960,16777215,4353791,16777215,16777215],this.data.geometry.vertices.length%2==1&&(this.data.geometry.vertices=this.data.geometry.vertices.slice(0,-1)),this.nodes=new Array(.5*this.data.geometry.vertices.length).fill(null).map(()=>{const t=new i.e;return this.nodeContainer.addChild(t),t}),this.data.geometry.visibles&&this.data.geometry.visibles.length===this.nodes.length||(this.data.geometry.visibles=new Array(this.nodes.length).fill(!0))}onNode(t,e,s){this.nodes.forEach((i,a)=>{i.removeAllListeners(t),i.interactive=!0,i.buttonMode=!0,i.cursor="grab",i.on(t,t=>{t.stopPropagation(),t.nodeIdx=a,t.shape=this.data,e(t)},s)})}createNodes(){this.nodes=new Array(.5*this.data.geometry.vertices.length).fill(null).map(()=>{const t=new i.e;return this.nodeContainer.addChild(t),t})}deleteNodes(){this.nodes.forEach(t=>{t.destroy(),this.nodeContainer.removeChild(t)})}draw(){if(this.area.clear(),this.data.geometry.edges.forEach(t=>{let e="default"===r.edgeColorType?this.hex:r.nodeColors[t[0]];e="nodes"===this.state||"box"===this.state?4353791:e,this.area.lineStyle(3,e||16777215,1,.5,!0);const s=Math.round(this.data.geometry.vertices[2*t[0]]*this.scaleX),i=Math.round(this.data.geometry.vertices[2*t[0]+1]*this.scaleY),a=Math.round(this.data.geometry.vertices[2*t[1]]*this.scaleX),n=Math.round(this.data.geometry.vertices[2*t[1]+1]*this.scaleY);this.area.moveTo(s,i),this.area.lineTo(a,n)}),this.nodes.length!==.5*this.data.geometry.vertices.length&&(this.deleteNodes(),this.createNodes()),this.nodes.length>1){const t=this.bounds,e=Math.round(t[0]*this.scaleX),s=Math.round(t[1]*this.scaleY),a=Math.round(t[2]*this.scaleX),r=Math.round(t[3]*this.scaleY);this.area.hitArea=new i.h(e,s,a-e,r-s)}this.box.clear(),this.controls.forEach(t=>t.clear()),this.nodes.forEach(t=>t.clear());for(let t=0;t<.5*this.data.geometry.vertices.length;t++){const e=this.data.geometry.vertices[2*t],s=this.data.geometry.vertices[2*t+1],i=this.data.geometry.visibles[t]?1:.3,a=r.nodeColors.length?r.nodeColors[t]:this.hex,n="nodes"===this.state||"box"===this.state?4353791:this.hex;this.nodes[t].clear(),this.nodes[t].beginFill(a,i),this.nodes[t].lineStyle(1,n,1,.5,!0),this.nodes[t].drawCircle(0,0,r.radius);const o=this.getHigherParent();o&&(this.nodes[t].scale.x=1.5/o.scale.x,this.nodes[t].scale.y=1.5/o.scale.y),this.nodes[t].x=Math.round(e*this.scaleX),this.nodes[t].y=Math.round(s*this.scaleY),this.nodes[t].endFill()}"contour"!==this.state&&"nodes"!==this.state||"contour"!==this.state&&"nodes"!==this.state||this.controls.forEach(t=>{t.interactive=!1})}pushNode(t,e){for(const[s,i]of this.data.geometry.vertices.slice(0,this.data.geometry.vertices.length-2).entries())if(s%2==0&&Math.round(i*this.scaleX)===Math.round(t*this.scaleX)&&Math.round(this.data.geometry.vertices[s+1]*this.scaleY)===Math.round(e*this.scaleY))return void console.warn("Same location. Abort.");this.data.geometry.vertices=[...this.data.geometry.vertices,t,e],this.data.geometry.visibles=[...this.data.geometry.visibles,!0]}popNode(){var t;this.data.geometry.vertices=this.data.geometry.vertices.slice(0,-2),this.data.geometry.visibles=null===(t=this.data.geometry.visibles)||void 0===t?void 0:t.slice(0,-1)}removeAllListeners(){return super.removeAllListeners(),this.nodes.forEach(t=>{t.interactive=!1,t.buttonMode=!1,t.removeAllListeners()}),this}}},321:function(t,e,s){"use strict";s.d(e,"b",(function(){return h})),s.d(e,"a",(function(){return c}));var i=s(167);class a{constructor(t){this.contours=new Array,this.nbPixels=0,this.cls=t}}class r{constructor(t,e){this.withExtrema=!1,this.blobs=new Map,this.targetId=[0,0,0],this.width=t.width,this.height=t.height,this.augW=t.width+2,this.augH=t.height+2;let[s,i,a,r]=[0,0,0,0];e?([s,i,a,r]=e,a-=1,r-=1,this.extrema=[s,i,a,r],this.withExtrema=!0):this.extrema=[0,1,this.augW-1,this.augH-2],this.max=this.augH*this.augW,this.pos=[1,this.augW+1,this.augW,this.augW-1,-1,-this.augW-1,-this.augW,1-this.augW],this.label=new Array(this.width*this.height);const n=document.createElement("canvas");n.width=this.augW,n.height=this.augH;const o=n.getContext("2d");o.putImageData(t,1,1,0,0,t.width,t.height),this.imgData=o.getImageData(0,0,this.augW,this.augH),e&&(this.extrema=[s,i+1,a+2,r+1]),this.augLabel=new Array(this.max)}origPos(t,e){return((t/e|0)-1)*(e-2)+t%e-1}addBorders(t){const e=new Array(this.augW*this.augH),[s,i,a,n]=this.extrema;if(this.withExtrema)for(let o=s;o<=a+2;o++)for(let h=i;h<=n+2;h++){const c=h*this.augW+o;e[c]=o===s||h===i||o===a+2||h===n+2?r.BACKGROUND:t[c-(this.width+2*h+1)]}else for(let s=0;s<this.augW;s++)for(let i=0;i<this.augH;i++){const a=i*this.augW+s;0===s||0===i||s===this.width+1||i===this.height+1?e[a]=r.BACKGROUND:e[a]=t[a-(this.width+2*i+1)]}return e}strPtToPos(t,e){const s=t/this.augW|0,i=(()=>{switch(e){case"tl":return t+s;case"tr":return t+s+1;case"bl":return t+(this.augW+1)+s;default:case"br":return t+(this.augW+1)+s+1}})();return this.origPos(i,this.augW+1)}addPoints(t,e,s,i){const a=new Array;switch(s){case 0:switch(i){case 0:a.push(this.strPtToPos(e,"tr"));break;case 2:a.push(this.strPtToPos(e,"tr")),a.push(this.strPtToPos(e,"br"));break;case 4:a.push(this.strPtToPos(e,"tr")),a.push(this.strPtToPos(e,"br")),a.push(this.strPtToPos(e,"bl"))}break;case 2:switch(i){case 0:break;case 2:a.push(this.strPtToPos(e,"br"));break;case 4:a.push(this.strPtToPos(e,"br")),a.push(this.strPtToPos(e,"bl"));break;case 6:a.push(this.strPtToPos(e,"br")),a.push(this.strPtToPos(e,"bl")),a.push(this.strPtToPos(e,"tl"))}break;case 4:switch(i){case 0:a.push(this.strPtToPos(e,"bl")),a.push(this.strPtToPos(e,"tl")),a.push(this.strPtToPos(e,"tr"));break;case 2:break;case 4:a.push(this.strPtToPos(e,"bl"));break;case 6:a.push(this.strPtToPos(e,"bl")),a.push(this.strPtToPos(e,"tl"))}break;case 6:switch(i){case 0:a.push(this.strPtToPos(e,"tl")),a.push(this.strPtToPos(e,"tr"));break;case 2:a.push(this.strPtToPos(e,"tl")),a.push(this.strPtToPos(e,"tr")),a.push(this.strPtToPos(e,"br"));break;case 4:break;case 6:a.push(this.strPtToPos(e,"tl"))}}return t.points.push(...a),t}tracer(t,e){let s=0;for(;s<8;){const i=(e+s)%8,a=t+this.pos[i];if(!(a<0||a>=this.max)){if(this.isEqual(a))return{T:a,q:i};this.augLabel[a]=r.MARKED,8===r.CONNEXITY?s++:s+=2}}return{T:t,q:-1}}contourTracing(t,e,s){let i;i=8===r.CONNEXITY?s?7:3:s?0:2;let a={type:s?"external":"internal",points:new Array};const n=new Set;let o=this.tracer(t,i);const h=o.T;let c=o.q;if(this.augLabel[t]=e,n.add(t),h===t)return 4===r.CONNEXITY&&(a.points.push(this.strPtToPos(t,"tl")),a.points.push(this.strPtToPos(t,"tr")),a.points.push(this.strPtToPos(t,"br")),a.points.push(this.strPtToPos(t,"bl"))),[a,n.size];let d=h,l=h;for(;l!==t||d!==h;)this.augLabel[d]=e,n.has(d)||n.add(d),l=d,i=8===r.CONNEXITY?(c+5)%8:(c+6)%8,o=this.tracer(l,i),4===r.CONNEXITY&&(a=this.addPoints(a,l,c,o.q)),d=o.T,c=o.q;return[a,n.size]}extract(t,e=!1){this.targetId=t;let s=0,i=0;for(let t=this.extrema[1];t<=this.extrema[3];t++){i=this.extrema[0]+t*this.augW;for(let t=this.extrema[0];t<=this.extrema[2];t++){if(this.isEqual(i)){if(!this.isEqual(i-this.augW)&&void 0===this.augLabel[i]){this.blobs.set(s,new a(s));const[t,e]=this.contourTracing(i,s,!0);this.blobs.get(s).contours.push(t),this.blobs.get(s).nbPixels+=e,s++}if(!this.isEqual(i+this.augW)&&void 0===this.augLabel[i+this.augW]){let t=this.augLabel[i-1];void 0!==this.augLabel[i]&&(t=this.augLabel[i]);const[e,s]=this.contourTracing(i,t,!1),a=this.blobs.get(t);a&&(a.contours.push(e),a.nbPixels+=s)}if(void 0===this.augLabel[i]){const t=this.augLabel[i-1]||0;this.augLabel[i]=t;const e=this.blobs.get(t);e&&(e.nbPixels+=1)}}i++}}if(e)for(let t=0;t<this.width;t++)for(let e=0;e<this.height;e++){const s=t+e*this.width;this.label[s]=this.augLabel[s+this.width+2*e+3]}}isEqualXY(t,e){const s=e*this.augW+t;return this.imgData.data[4*s+0]===this.targetId[0]&&this.imgData.data[4*s+1]===this.targetId[1]&&this.imgData.data[4*s+2]===this.targetId[2]}isEqual(t){return this.imgData.data[4*t+0]===this.targetId[0]&&this.imgData.data[4*t+1]===this.targetId[1]&&this.imgData.data[4*t+2]===this.targetId[2]}}r.BACKGROUND=null,r.MARKED=-2,r.CONNEXITY=4;var n=s(259);const o=[200,200,200];var h;!function(t){t.SEMANTIC="SEMANTIC",t.INSTANCE="INSTANCE"}(h||(h={}));class c extends i.d{constructor(){super(),this.colorMask=new i.j,this.lockedInstances=new Set,this.maskVisuMode=h.INSTANCE,this.orig=null,this.fusedIds=new Set,this.clsMap=new Map([[0,[0,0,0,0]],[1,[255,0,0,1]],[2,[0,255,0,0]]]),this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.pixels=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height),this.origCanvas=document.createElement("canvas")}initialize(t){this.canvas.width=t.width,this.canvas.height=t.height,this.colorMask.destroy(),this.colorMask=new i.j(i.l.from(this.canvas)),this.removeChildren(),this.addChild(this.colorMask),this.setValue(t)}setBase64(t){if("string"!=typeof t)return Promise.resolve();const e=new Image;return new Promise(s=>{e.onload=()=>{this.canvas.width=e.width,this.canvas.height=e.height,this.colorMask.destroy(),this.colorMask=new i.j(i.l.from(this.canvas)),this.removeChildren(),this.addChild(this.colorMask),this.canvas.getContext("2d").drawImage(e,0,0,e.width,e.height);const t=this.canvas.getContext("2d").getImageData(0,0,this.canvas.width,this.canvas.height);this.setValue(t),s()},e.src="data:image/png;base64,"+t.replace("data:image/png;base64,","")})}getBase64(){if(this.orig){this.origCanvas.width=this.canvas.width,this.origCanvas.height=this.canvas.height;const t=this.origCanvas.getContext("2d");t.putImageData(this.orig,0,0,0,0,this.canvas.width,this.canvas.height);return t.canvas.toDataURL("image/png")}return""}empty(t=100,e=100){this.canvas.width=t,this.canvas.height=e,this.colorMask.destroy(),this.colorMask=new i.j(i.l.from(this.canvas)),this.removeChildren(),this.addChild(this.colorMask),this.orig=new ImageData(t,e),this.fusedIds.clear();this.canvas.getContext("2d").putImageData(new ImageData(t,e),0,0,0,0,this.canvas.width,this.canvas.height),this.colorMask.texture.update()}getNextId(){const t=new Set([...this.fusedIds].map(t=>Math.floor(t%65536))),e=new Array(65535).findIndex((e,s)=>!t.has(s+1))+1;return[e%256,Math.floor(e/256)]}getValue(){return this.orig}pixelToColor(t,e,s){if(0===s)return[0,0,0];const i=this.clsMap.get(s);if(!i)return[0,0,0];if(this.maskVisuMode===h.SEMANTIC||0===i[3])return[i[0],i[1],i[2]];if(this.maskVisuMode===h.INSTANCE){const i=Object(n.e)([t,e,s]);return n.c[i%n.c.length]}return console.warn("this should never happen"),[0,0,0]}setValue(t){this.orig=t,this.fusedIds.clear();for(let t=0;t<this.canvas.width;t++)for(let e=0;e<this.canvas.height;e++){const[s,i,a]=this.pixelId(t+e*this.canvas.width);this.fusedIds.add(Object(n.e)([s,i,a]))}this.recomputeColor()}recomputeColor(){const t=this.canvas.getContext("2d"),e=t.getImageData(0,0,this.canvas.width,this.canvas.height);for(let t=0;t<this.canvas.width;t++)for(let s=0;s<this.canvas.height;s++){const i=t+s*this.canvas.width,[a,r,h]=this.pixelId(i),c=Object(n.e)([a,r,h]);this.fusedIds.add(c);let d=this.pixelToColor(a,r,h);d=this.lockedInstances.has(c)?o:d;const l=0===Math.max(...d)?0:255;e.data[4*i]=d[0],e.data[4*i+1]=d[1],e.data[4*i+2]=d[2],e.data[4*i+3]=l}t.putImageData(e,0,0,0,0,this.canvas.width,this.canvas.height),this.colorMask.texture.update()}pixelId(t){return[this.orig.data[4*t],this.orig.data[4*t+1],this.orig.data[4*t+2]]}getMajorId(t,e,s){const[a,r,o,h]=e,c=Object(n.e)(s),d=new Map,l=new Array,u=new Map;for(let e=a-1;e<=r;e++)for(let s=o-1;s<=h;s++)if(Object(n.h)(new i.f(e,s),t)){const t=e+s*this.canvas.width,i=this.pixelId(t);if(Object(n.e)(i)!==c){const t=Object(n.e)(i),e=d.get(t);e?d.set(t,e+1):d.set(t,1)}else l.push(t)}else if(e>=0&&e<this.canvas.width&&s>=0&&s<this.canvas.height){const t=e+s*this.canvas.width,i=this.pixelId(t);if(Object(n.e)(i)!==c){const t=Object(n.e)(i),e=u.get(t);e?u.set(t,e+1):u.set(t,1)}}return 0===d.size?0!==u.size?[Object(n.i)([...u.keys()].reduce((t,e)=>u.get(t)>u.get(e)?t:e)),l]:[[0,0,0],l]:[Object(n.i)([...d.keys()].reduce((t,e)=>d.get(t)>d.get(e)?t:e)),l]}updateByMaskInRoi(t,e,s,i="add"){const a=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height),r=e[2]-e[0],o=[e[0]>0?e[0]:0,e[1]>0?e[1]:0,e[2]<this.canvas.width?e[2]:this.canvas.width,e[3]<this.canvas.height?e[3]:this.canvas.height],h=o[2]-o[0],c=o[3]-o[1],d=e[0]<0?-e[0]:0,l=e[1]<0?-e[1]:0,u=this.pixelToColor(...s),g=0===Math.max(...u)?0:255,[f,p,v]=s;if("add"===i)for(let e=0;e<h;e++)for(let s=0;s<c;s++){const i=e+o[0]+(s+o[1])*this.canvas.width,h=this.pixelId(i);1!==t[(s+l)*r+(e+d)]||this.lockedInstances.has(Object(n.e)(h))||(this.orig.data[4*i]=f,this.orig.data[4*i+1]=p,this.orig.data[4*i+2]=v,this.orig.data[4*i+3]=g,a.data[4*i]=u[0],a.data[4*i+1]=u[1],a.data[4*i+2]=u[2],a.data[4*i+3]=g)}else if("remove"===i){const e=Object(n.e)(s);for(let s=0;s<h;s++)for(let i=0;i<c;i++){const h=s+o[0]+(i+o[1])*this.canvas.width,c=this.pixelId(h);1!==t[(i+l)*r+(s+d)]||this.lockedInstances.has(Object(n.e)(c))||Object(n.e)(c)!==e||(this.orig.data[4*h]=0,this.orig.data[4*h+1]=0,this.orig.data[4*h+2]=0,this.orig.data[4*h+3]=0,a.data[4*h]=0,a.data[4*h+1]=0,a.data[4*h+2]=0,a.data[4*h+3]=0)}}this.ctx.putImageData(a,0,0,0,0,this.canvas.width,this.canvas.height),this.colorMask.texture.update()}updateByPolygon(t,e,s="add"){const a=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height);let[r,o,h,c]=Object(n.g)(t);if(r<0&&(r=0),o<0&&(o=0),h>this.canvas.width&&(h=this.canvas.width-1),c>this.canvas.height&&(c=this.canvas.height-1),!this.lockedInstances.has(Object(n.e)(e))){if("add"===s){const[s,d,l]=e,u=this.pixelToColor(s,d,l),g=0===Math.max(...u)?0:255;for(let e=r;e<=h;e++)for(let r=o;r<=c;r++)if(Object(n.h)(new i.f(e,r),t)){const t=e+r*this.canvas.width,i=this.pixelId(t);this.lockedInstances.has(Object(n.e)(i))||(this.orig.data[4*t]=s,this.orig.data[4*t+1]=d,this.orig.data[4*t+2]=l,this.orig.data[4*t+3]=g,a.data[4*t]=u[0],a.data[4*t+1]=u[1],a.data[4*t+2]=u[2],a.data[4*t+3]=g)}}else if("remove"===s){const[[s,i,d],l]=this.getMajorId(t,[r,h,o,c],e),u=this.pixelToColor(s,i,d),g=0===Math.max(...u)?0:255;l.forEach(t=>{const e=this.pixelId(t);this.lockedInstances.has(Object(n.e)(e))||(this.orig.data[4*t]=s,this.orig.data[4*t+1]=i,this.orig.data[4*t+2]=d,this.orig.data[4*t+3]=g,a.data[4*t]=u[0],a.data[4*t+1]=u[1],a.data[4*t+2]=u[2],a.data[4*t+3]=g)})}this.ctx.putImageData(a,0,0,0,0,this.canvas.width,this.canvas.height),this.colorMask.texture.update()}}deleteInstance(t){this.replaceValue(t,[0,0,0])}getBlobs(t,e){const s=new r(this.orig,e);return s.extract(t),s.blobs}replaceValue(t,e){const[s,i,a]=e,r=this.canvas.getContext("2d"),n=r.getImageData(0,0,this.canvas.width,this.canvas.height),o=this.pixelToColor(s,i,a),h=0===Math.max(...o)?0:255;for(let e=0;e<this.canvas.width*this.canvas.height;e++){const r=this.pixelId(e);if(r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]){const t=4*e;this.orig.data[t]=s,this.orig.data[t+1]=i,this.orig.data[t+2]=a,this.orig.data[t+3]=h,n.data[t]=o[0],n.data[t+1]=o[1],n.data[t+2]=o[2],n.data[t+3]=h}}r.putImageData(n,0,0,0,0,this.canvas.width,this.canvas.height),this.colorMask.texture.update()}}},370:function(t,e){t.exports={PATH_SEPARATOR:".",TARGET:Symbol("target"),UNSUBSCRIBE:Symbol("unsubscribe")}},371:function(t,e,s){"use strict";const{PATH_SEPARATOR:i}=s(370),a=s(380),r=s(372);t.exports={after:(t,e)=>a(t)?t.slice(e.length):""===e?t:t.slice(e.length+1),concat:(t,e)=>a(t)?(t=t.slice(),e&&t.push(e),t):e&&void 0!==e.toString?(""!==t&&(t+=i),r(e)?t+e.toString():t+e):t,initial:t=>{if(a(t))return t.slice(0,-1);if(""===t)return t;const e=t.lastIndexOf(i);return-1===e?"":t.slice(0,e)},last:t=>{if(a(t))return t[t.length-1]||"";if(""===t)return t;const e=t.lastIndexOf(i);return-1===e?t:t.slice(e+1)},walk:(t,e)=>{if(a(t))t.forEach(t=>e(t));else if(""!==t){let s=0,a=t.indexOf(i);if(-1===a)e(t);else for(;s<t.length;)-1===a&&(a=t.length),e(t.slice(s,a)),s=a+1,a=t.indexOf(i,s)}}}},372:function(t,e,s){"use strict";t.exports=t=>"symbol"==typeof t},375:function(t,e,s){"use strict";s.d(e,"a",(function(){return n})),s.d(e,"b",(function(){return o}));var i=s(167),a=s(100),r=s(120);const n=[{cursor:"ns-resize",x:.5,y:0},{cursor:"ns-resize",x:.5,y:1},{cursor:"ew-resize",x:1,y:.5},{cursor:"ew-resize",x:0,y:.5},{cursor:"nwse-resize",x:0,y:0},{cursor:"nesw-resize",x:1,y:0},{cursor:"nesw-resize",x:0,y:1},{cursor:"nwse-resize",x:1,y:1}];class o extends i.d{constructor(t){super(),this.area=new i.e,this.scaleX=100,this.scaleY=100,this.box=new i.e,this.controls=[],this.nodeContainer=new i.d,this.showNodes=!1,this.state="none",this.hex=16711680,this.addChild(this.area),this.addChild(this.box),this.addChild(this.nodeContainer),this.data=t,this.onChange=this.onChange.bind(this),Object(a.d)(t,this.onChange),this.updateColorHex(),this.controls=new Array(8).fill(null).map(()=>new i.e),this.controls.forEach(t=>this.nodeContainer.addChild(t))}getHigherParent(t){if((t=t||this).parent)return this.getHigherParent(t.parent);try{return t.scale.x?t:null}catch(t){return null}}updateColorHex(){if("string"==typeof this.data.color){const t=Object(r.colorToHex)(this.data.color);this.hex=parseInt(t.replace(/^#/,""),16)}else this.data.color&&(this.hex=this.data.color)}onChange(t){t.startsWith("geometry")?this.draw():"color"===t&&(this.updateColorHex(),this.draw())}get bounds(){let t=1,e=0,s=1,i=0;return this.data.geometry.vertices.forEach((a,r)=>{r%2==0?(a<t&&(t=a),a>e&&(e=a)):(a<s&&(s=a),a>i&&(i=a))}),[t,s,e,i]}set interactive(t){for(const e of this.children)e.interactive=t,e.buttonMode=!0}translate(t,e){const s=this.bounds;t=Math.min(t,1-s[2]),t=Math.max(t,0-s[0]),e=Math.min(e,1-s[3]),e=Math.max(e,0-s[1]),this.data.geometry.vertices=this.data.geometry.vertices.map((s,i)=>s=i%2==0?Math.min(1,s+t):Math.min(1,s+e))}on(t,e,s){return this.area.removeListener(t),this.area.on(t,s=>{"pointerdown"===t&&s.stopPropagation(),s.shape=this.data,e(s)},s),this}drawBox(){const[t,e,s,a]=this.bounds,r=Math.round(t*this.scaleX),o=Math.round(s*this.scaleX),h=Math.round(e*this.scaleY),c=Math.round(a*this.scaleY);this.box.lineStyle(1,16777215,1,.5,!0),this.box.drawRect(r,h,o-r,c-h),this.controls.forEach((t,e)=>{t.beginFill(10934503,1),t.lineStyle(1,4353791,1,.5,!0),t.drawRect(-2,-2,4,4),t.hitArea=new i.c(0,0,10);const s=r+n[e].x*(o-r),a=h+n[e].y*(c-h);t.x=Math.round(s),t.y=Math.round(a),this.parent&&(t.scale.x=1.5/this.parent.parent.scale.x,t.scale.y=1.5/this.parent.parent.scale.y),t.endFill(),t.interactive=!0,t.buttonMode=!0,t.cursor=n[e].cursor})}destroy(){super.destroy(),Object(a.e)(this.data,this.onChange)}}},379:function(t,e,s){"use strict";const i={withMutableMethods:t=>t instanceof Date||t instanceof Set||t instanceof Map||t instanceof WeakSet||t instanceof WeakMap,withoutMutableMethods:t=>("object"==typeof t?null===t:"function"!=typeof t)||t instanceof RegExp};t.exports=i},380:function(t,e,s){"use strict";t.exports=Array.isArray},393:function(t,e,s){"use strict";const{TARGET:i,UNSUBSCRIBE:a}=s(370),r=s(379),n=s(371),o=s(372),h=s(394),c=s(395),d=s(396),l=s(397),u=s(398),g={equals:Object.is,isShallow:!1,pathAsArray:!1,ignoreSymbols:!1,ignoreUnderscores:!1,ignoreDetached:!1},f=(t,e,s={})=>{s={...g,...s};const f=Symbol("ProxyTarget"),{equals:p,isShallow:v,ignoreDetached:y}=s,m=new l(p),b=new u,w=(e,i,a,r)=>{d(m,s,i)||y&&m.isDetached(e,t)||x(m.getPath(e),i,a,r)},x=(t,s,i,a,r)=>{b.isCloning?b.update(t,s,i):e(n.concat(t,s),a,i,r)},M=t=>t&&t[f]||t,C=(e,i,a,o)=>r.withoutMutableMethods(e)||"constructor"===a||v&&!u.isHandledMethod(i,a)||d(m,s,a)||m.isGetInvariant(i,a)||y&&m.isDetached(i,t)?e:(void 0===o&&(o=m.getPath(i)),m.getProxy(e,n.concat(o,a),P,f)),P={get(t,e,s){if(o(e)){if(e===f||e===i)return t;if(e===a&&!m.isUnsubscribed&&0===m.getPath(t).length)return m.unsubscribe(),t}const n=r.withMutableMethods(t)?Reflect.get(t,e):Reflect.get(t,e,s);return C(n,t,e)},set(t,e,s,i){s=M(s);const a=t[f]||t,r=a[e],n=e in t;return!!m.setProperty(a,e,s,i,r)&&(p(r,s)&&n||w(t,e,r,s),!0)},defineProperty(t,e,s){if(!m.isSameDescriptor(s,t,e)){if(!m.defineProperty(t,e,s))return!1;w(t,e,void 0,s.value)}return!0},deleteProperty(t,e){if(!Reflect.has(t,e))return!0;const s=Reflect.get(t,e);return!!m.deleteProperty(t,e,s)&&(w(t,e,s),!0)},apply(t,e,s){const i=e[f]||e;if(m.isUnsubscribed)return Reflect.apply(t,i,s);if(u.isHandledType(i)){const a=n.initial(m.getPath(t)),r=u.isHandledMethod(i,t.name);b.start(i,a,s);const o=Reflect.apply(t,b.preferredThisArg(t,e,i),r?s.map(t=>M(t)):s),d=b.isChanged(i,p,s),l=b.stop();return d&&(b.isCloning?x(n.initial(a),n.last(a),l,i,t.name):x(a,"",l,i,t.name)),(e instanceof Map||e instanceof Set)&&h(o)?c(o,t,e,a,C):u.isHandledType(o)&&r?m.getProxy(o,a,P,f):o}return Reflect.apply(t,e,s)}},T=m.getProxy(t,s.pathAsArray?[]:"",P);return e=e.bind(T),T};f.target=t=>t[i]||t,f.unsubscribe=t=>t[a]||t,t.exports=f},394:function(t,e,s){"use strict";t.exports=t=>"object"==typeof t&&"function"==typeof t.next},395:function(t,e,s){"use strict";const{TARGET:i}=s(370);t.exports=(t,e,s,a,r)=>{const n=t.next;if("entries"===e.name)t.next=function(){const t=n.call(this);return!1===t.done&&(t.value[0]=r(t.value[0],e,t.value[0],a),t.value[1]=r(t.value[1],e,t.value[0],a)),t};else if("values"===e.name){const o=s[i].keys();t.next=function(){const t=n.call(this);return!1===t.done&&(t.value=r(t.value,e,o.next().value,a)),t}}else t.next=function(){const t=n.call(this);return!1===t.done&&(t.value=r(t.value,e,t.value,a)),t};return t}},396:function(t,e,s){"use strict";const i=s(372);t.exports=(t,e,s)=>t.isUnsubscribed||e.ignoreSymbols&&i(s)||e.ignoreUnderscores&&"_"===s.charAt(0)||"ignoreKeys"in e&&e.ignoreKeys.includes(s)},397:function(t,e,s){"use strict";const i=s(371);t.exports=class{constructor(t){this._equals=t,this._proxyCache=new WeakMap,this._pathCache=new WeakMap,this.isUnsubscribed=!1}_getDescriptorCache(){return void 0===this._descriptorCache&&(this._descriptorCache=new WeakMap),this._descriptorCache}_getProperties(t){const e=this._getDescriptorCache();let s=e.get(t);return void 0===s&&(s={},e.set(t,s)),s}_getOwnPropertyDescriptor(t,e){if(this.isUnsubscribed)return Reflect.getOwnPropertyDescriptor(t,e);const s=this._getProperties(t);let i=s[e];return void 0===i&&(i=Reflect.getOwnPropertyDescriptor(t,e),s[e]=i),i}getProxy(t,e,s,i){if(this.isUnsubscribed)return t;this._pathCache.set(t,e);let a=this._proxyCache.get(t);return void 0===a&&(a=void 0===t[i]?new Proxy(t,s):t,this._proxyCache.set(t,a)),a}getPath(t){return this.isUnsubscribed?void 0:this._pathCache.get(t)}isDetached(t,e){return i.walk(this.getPath(t),t=>{e&&(e=e[t])}),!Object.is(t,e)}defineProperty(t,e,s){return!!Reflect.defineProperty(t,e,s)&&(this.isUnsubscribed||(this._getProperties(t)[e]=s),!0)}setProperty(t,e,s,i,a){if(!this._equals(a,s)||!(e in t)){const a=this._getOwnPropertyDescriptor(t,e);return void 0!==a&&"set"in a?Reflect.set(t,e,s,i):Reflect.set(t,e,s)}return!0}deleteProperty(t,e,s){if(Reflect.deleteProperty(t,e)){if(!this.isUnsubscribed){const i=this._getDescriptorCache().get(t);i&&(delete i[e],this._pathCache.delete(s))}return!0}return!1}isSameDescriptor(t,e,s){const i=this._getOwnPropertyDescriptor(e,s);return void 0!==t&&void 0!==i&&Object.is(t.value,i.value)&&(t.writable||!1)===(i.writable||!1)&&(t.enumerable||!1)===(i.enumerable||!1)&&(t.configurable||!1)===(i.configurable||!1)&&t.get===i.get&&t.set===i.set}isGetInvariant(t,e){const s=this._getOwnPropertyDescriptor(t,e);return void 0!==s&&!0!==s.configurable&&!0!==s.writable}unsubscribe(){this._descriptorCache=null,this._pathCache=null,this._proxyCache=null,this.isUnsubscribed=!0}}},398:function(t,e,s){"use strict";const i=s(371),a=s(380),r=s(379),n=s(399),o=()=>!0,h=(t,e)=>t.length!==e.length||t.some((t,s)=>e[s]!==t),c=(t,e)=>{if(t.size!==e.size)return!0;for(const s of t)if(!e.has(s))return!0;return!1},d=(t,e)=>{if(t.size!==e.size)return!0;let s;for(const[i,a]of t)if(s=e.get(i),s!==a||void 0===s&&!e.has(i))return!0;return!1},l=new Set(["hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),u=new Set(["concat","includes","indexOf","join","keys","lastIndexOf"]),g=new Set(["has","toString"]),f=new Set([...g].concat(["get"])),p={push:o,pop:o,shift:o,unshift:o,copyWithin:h,reverse:h,sort:h,splice:h,flat:h,fill:h},v={add:c,clear:c,delete:c},y=["keys","values","entries"],m={set:d,clear:d,delete:d},b=new Set([...l].concat([...u]).concat(Object.keys(p))),w=new Set([...g].concat(Object.keys(v)).concat(y)),x=new Set([...f].concat(Object.keys(m)).concat(y));class M{constructor(t,e,s){this._path=e,this._isChanged=!1,this._clonedCache=new Set,t instanceof WeakSet?this._weakValue=t.has(s[0]):t instanceof WeakMap?this._weakValue=t.get(s[0]):this.clone=void 0===e?t:this._shallowClone(t)}_shallowClone(t){let e;return n(t)?e={...t}:a(t)?e=[...t]:t instanceof Date?e=new Date(t):t instanceof Set?e=new Set(t):t instanceof Map&&(e=new Map(t)),this._clonedCache.add(e),e}preferredThisArg(t,e,s){const{name:i}=t;return C.isHandledMethod(s,i)?(a(s)?this._onIsChanged=p[i]:s instanceof Set?this._onIsChanged=v[i]:s instanceof Map&&(this._onIsChanged=m[i]),s):e}update(t,e,s){if(void 0!==s&&"length"!==e){let a=this.clone;i.walk(i.after(t,this._path),t=>{this._clonedCache.has(a[t])||(a[t]=this._shallowClone(a[t])),a=a[t]}),a[e]=s}this._isChanged=!0}isChanged(t,e,s){return t instanceof Date?!e(this.clone.valueOf(),t.valueOf()):t instanceof WeakSet?this._weakValue!==t.has(s[0]):t instanceof WeakMap?this._weakValue!==t.get(s[0]):void 0===this._onIsChanged?this._isChanged:this._onIsChanged(this.clone,t)}}class C{constructor(){this.stack=[]}static isHandledType(t){return n(t)||a(t)||r.withMutableMethods(t)}static isHandledMethod(t,e){return n(t)?l.has(e):a(t)?b.has(e):t instanceof Set?w.has(e):t instanceof Map?x.has(e):r.withMutableMethods(t)}get isCloning(){return 0!==this.stack.length}start(t,e,s){this.stack.push(new M(t,e,s))}update(t,e,s){this.stack[this.stack.length-1].update(t,e,s)}preferredThisArg(t,e,s){return this.stack[this.stack.length-1].preferredThisArg(t,e,s)}isChanged(t,e,s,i){return this.stack[this.stack.length-1].isChanged(t,e,s,i)}stop(){return this.stack.pop().clone}}t.exports=C},399:function(t,e,s){"use strict";t.exports=t=>"[object Object]"===toString.call(t)}}]);